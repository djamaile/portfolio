"use strict";(self.webpackChunkdjamaile_dev=self.webpackChunkdjamaile_dev||[]).push([[120],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=p(n),d=a,g=m["".concat(l,".").concat(d)]||m[d]||u[d]||o;return n?r.createElement(g,i(i({ref:t},c),{},{components:n})):r.createElement(g,i({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3939:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},assets:function(){return c},toc:function(){return u},default:function(){return d}});var r=n(7462),a=n(3366),o=(n(7294),n(3905)),i=["components"],s={slug:"how-to-setup-husky-eslint-prettier",title:"How to setup husky, eslint and prettier within minutes",author:"Djamaile Rahamat",author_title:"Software Engineer",author_url:"https://github.com/djamaile",author_image_url:"https://avatars.githubusercontent.com/u/15789670?v=4",tags:["react","typescript"]},l=void 0,p={permalink:"/blog/how-to-setup-husky-eslint-prettier",editUrl:"https://github.com/djamaile/portfolio/edit/master/blog/2021-10-12-how-to-setup-husky-eslint-prettier.md",source:"@site/blog/2021-10-12-how-to-setup-husky-eslint-prettier.md",title:"How to setup husky, eslint and prettier within minutes",description:"Every project these days needs a linter of some sorts. So, let\u2019s set one up for our React/Typescript project!",date:"2021-10-12T00:00:00.000Z",formattedDate:"October 12, 2021",tags:[{label:"react",permalink:"/blog/tags/react"},{label:"typescript",permalink:"/blog/tags/typescript"}],readingTime:4.625,truncated:!0,authors:[{name:"Djamaile Rahamat",title:"Software Engineer",url:"https://github.com/djamaile",imageURL:"https://avatars.githubusercontent.com/u/15789670?v=4"}],prevItem:{title:"Using KEDA and Prometheus to scale your k8s workloads",permalink:"/blog/using-keda-and-prometheus"},nextItem:{title:"How I structure my React /TS applications (2021)",permalink:"/blog/how-i-structure-my-react-ts-applications-2021"}},c={authorsImageUrls:[void 0]},u=[{value:"Starting up",id:"starting-up",children:[]},{value:"Installing packages",id:"installing-packages",children:[]},{value:"Configure package json",id:"configure-package-json",children:[]},{value:"Ignore files",id:"ignore-files",children:[]},{value:"Testing",id:"testing",children:[]}],m={toc:u};function d(e){var t=e.components,n=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Every project these days needs a linter of some sorts. So, let\u2019s set one up for our React/Typescript project!"),(0,o.kt)("p",null,"repository: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/djamaile/hep-demo"},"https://github.com/djamaile/hep-demo")),(0,o.kt)("h3",{id:"starting-up"},"Starting up"),(0,o.kt)("p",null,"Let\u2019s first generate a simple React project by using ",(0,o.kt)("inlineCode",{parentName:"p"},"create-react-app"),". Execute the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"npx create-react-app hep-demo --template typescript && cd hep-demo\n")),(0,o.kt)("p",null,"Start the app and see if everything is working properly:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"yarn start\n")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},'If you encounter a issue with "babel-jest": "^26.6.0" add a .env file with ',(0,o.kt)("inlineCode",{parentName:"p"},"SKIP_PREFLIGHT_CHECK=true")," (echo 'SKIP_PREFLIGHT_CHECK=true' > .env )"))),(0,o.kt)("h3",{id:"installing-packages"},"Installing packages"),(0,o.kt)("p",null,"Now that our app is working we can start by adding the needed packages.\nFor this setup we would need prettier, husky, lint-staged, eslint-config-airbnb and spotify/prettier-config.\nThe last one is optional, you can also create your own prettier config but recently\nI have been using spotify's config with pleasant results. "),(0,o.kt)("p",null,"To install the packages, execute the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"yarn add @spotify/prettier-config @typescript-eslint/parser husky lint-staged prettier -D\n")),(0,o.kt)("p",null,"We will use the eslint config of airbnb to do that execute the following command: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"npx install-peerdeps --dev eslint-config-airbnb\n")),(0,o.kt)("p",null,"In the root of your project, create a file called ",(0,o.kt)("inlineCode",{parentName:"p"},".eslintrc.json")," and add the following content to it:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "extends": [\n    "airbnb"\n  ],\n  "parser": "@typescript-eslint/parser",\n  "env": {\n    "browser": true,\n    "commonjs": true,\n    "es6": true,\n    "jest": true,\n    "node": true\n  },\n  "rules": {\n    "no-console": "off",\n    "import/prefer-default-export": "off",\n    "@typescript-eslint/camelcase": ["off"],\n    "camelcase": ["off"],\n    "react/jsx-props-no-spreading": ["off"],\n    "jsx-a11y/no-static-element-interactions": "off",\n    "react/prop-types": ["off"],\n    "jsx-a11y/href-no-hash": ["off"],\n    "jsx-a11y/click-events-have-key-events": ["off"],\n    "import/no-unresolved": ["off"],\n    "import/extensions": 0,\n    "no-use-before-define": "off",\n    "react/jsx-uses-react": "off",\n    "react/react-in-jsx-scope": "off",\n    "react/jsx-filename-extension": [\n      "warn",\n      {\n        "extensions": [".js", ".jsx", ".tsx", ".ts"]\n      }\n    ],\n    "max-len": [\n      "warn",\n      {\n        "code": 100,\n        "tabWidth": 2,\n        "comments": 80,\n        "ignoreComments": false,\n        "ignoreTrailingComments": true,\n        "ignoreUrls": true,\n        "ignoreStrings": true,\n        "ignoreTemplateLiterals": true,\n        "ignoreRegExpLiterals": true\n      }\n    ]\n  }\n}\n')),(0,o.kt)("p",null,"You, of course, don\u2019t have to use the same rules as mine. Play with it and see what fits you the best!"),(0,o.kt)("h3",{id:"configure-package-json"},"Configure package json"),(0,o.kt)("p",null,"Once the packages are installed, we can make some changes in our package.json. Let\u2019s first start with some handy scripts:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'"scripts": {\n    ...\n    "prettier:check": "prettier --check .",\n    "prettier:write": "prettier --write .",\n    "prepare": "husky install"\n}\n')),(0,o.kt)("p",null,"The prettier commands are there to check your code and the prepare script we will use in a bit to set up husky with a pre-commit hook."),(0,o.kt)("p",null,"But first in your ",(0,o.kt)("inlineCode",{parentName:"p"},"package.json")," down below you can set prettier to ",(0,o.kt)("inlineCode",{parentName:"p"},"@spotify/prettier-config")," and under that you can specify the ",(0,o.kt)("inlineCode",{parentName:"p"},"lint-staged")," section."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'"prettier": "@spotify/prettier-config",\n"lint-staged": {\n    "*.{js,jsx,ts,tsx}": [\n      "eslint --fix",\n      "prettier --write"\n    ],\n    "*.{json,md}": [\n      "prettier --write"\n    ]\n}\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"lint-staged")," will execute those commands on files that are ready to be committed. Basically, it will run its specified linter on all staged git files. But before that is possible, we need to make sure that husky triggers ",(0,o.kt)("inlineCode",{parentName:"p"},"lint-staged"),"."),(0,o.kt)("p",null,"In the root of your project run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"yarn prepare\n")),(0,o.kt)("p",null,"Which will create the ",(0,o.kt)("inlineCode",{parentName:"p"},".husky")," folder in your project and after we can install a pre-commit hook:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'npx husky add .husky/pre-commit "yarn lint-staged" \n')),(0,o.kt)("p",null,"This will create a pre-commit hook in the ",(0,o.kt)("inlineCode",{parentName:"p"},".husky")," folder. If we inspect the contents of the file you can see that it will run ",(0,o.kt)("inlineCode",{parentName:"p"},"yarn lint-staged"),"."),(0,o.kt)("h3",{id:"ignore-files"},"Ignore files"),(0,o.kt)("p",null,"Before we can test if it works, we should also create .ignore files for prettier and eslint. We don't want to end up scanning the ",(0,o.kt)("inlineCode",{parentName:"p"},"node_modules")," folder! Create the files:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"touch .eslintignore\ntouch .prettierignore\n")),(0,o.kt)("p",null,"In both of the files you can add the same folders to ignore:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"**/node_modules/**\n**/build/**\n**/dist/**\n**/.git/**\n**/public/**\n")),(0,o.kt)("h3",{id:"testing"},"Testing"),(0,o.kt)("p",null,"Now we can actually test if our setup works! First, we\u2019ll need to set up a git for our project:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'git init\ngit add .\ngit commit -m "first commit"\n')),(0,o.kt)("p",null,"After you try to commit, you can see husky in action. It will execute ",(0,o.kt)("inlineCode",{parentName:"p"},"yarn lint-staged")," which in turns calls prettier and eslint for our git staged files."),(0,o.kt)("p",null,"To see if it works on new stuff, let\u2019s create a file called ",(0,o.kt)("inlineCode",{parentName:"p"},"Button.tsx")," in the src directory. Once you have done that, add the following code to it:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"import React from 'react';\n\ninterface Props {\n  size: string;\n}\n\nexport const Button: React.FC<Props> = ({size}) => {\n  size = 'big'; return <button>{size}</button>;\n};\n")),(0,o.kt)("p",null,"So, this piece of code is wrong but let eslint tell us why. Add the file and try to commit it:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'git add .\ngit commit -m "feat: add button component"\n')),(0,o.kt)("p",null,"If eslint is working well you should receive this error:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"}," error  Assignment to function parameter 'size'      no-param-reassign\n\n error  Missing an explicit type attribute for button  react/button-has-type\n\n")),(0,o.kt)("p",null,"Seems like we have some errors, so let\u2019s fix them before committing our button. Overwrite ",(0,o.kt)("inlineCode",{parentName:"p"},"Button.tsx")," with the fixed code:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"import React from 'react';\n\ninterface Props {\n size: string;\n}\n\nexport const Button: React.FC<Props> = ({ size }) => {\n const rightSize = size ? 'big' : 'small'; return <button type=\"button\">{rightSize}</button>;\n};\n")),(0,o.kt)("p",null,"The code now looks good, but the styling might look a bit off. But that is okay. We are going to let prettier handle that. Let\u2019s try again to add and commit our Button component."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'git add .\ngit commit -m "feat: add button component"\n')),(0,o.kt)("p",null,"Now we should be greeted by green light and that our component is commited! In addition, if we look at the button component we can see that prettier has rewritten our component, to make it look nicer!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"import React from 'react';\n\ninterface Props {\n  size: string;\n}\n\nexport const Button: React.FC<Props> = ({ size }) => {\n  const rightSize = size ? 'big' : 'small';\n  return <button type=\"button\">{rightSize}</button>;\n};\n")))}d.isMDXComponent=!0}}]);